{% liquid
  assign card_product = product
  if card_product == blank and passed_product
    assign card_product = passed_product
  endif
  assign card_url = url | default: card_product.url
  assign card_title = title | default: card_product.title
  assign card_price = price | default: card_product.price
  assign card_compare_at = compare_at_price | default: card_product.compare_at_price
  assign card_image = image | default: card_product.featured_image
  assign quick_variant = card_product.selected_or_first_available_variant
  assign link_overlay = wrap_link | default: false
  
  assign product_form_id = 'quick-add-' | append: section.id | append: card_product.id
%}

<div class="product-card grid-view-item flex flex-col bg-white border border-gray-200 group relative overflow-hidden" data-product-id="{{ card_product.id }}">
  <div class="relative overflow-hidden bg-white">
    {% if card_image %}
      <img
        class="w-full h-auto object-contain"
        src="{{ card_image | image_url: width: 600 }}"
        alt="{{ card_image.alt | escape }}"
        loading="lazy"
        width="600"
        height="600" />
    {% else %}
      <div class="w-full aspect-square bg-gray-50 flex items-center justify-center">
        <span class="text-gray-400">No image</span>
      </div>
    {% endif %}

    {% if link_overlay and card_url %}
      <a
        href="{{ card_url }}"
        class="absolute inset-0 z-10"
        aria-label="{{ card_title | escape }}"></a>
    {% endif %}

    <div class="h-12 absolute bottom-0 left-1/2 -translate-x-1/2 w-[80%] bg-[#BDE399] flex items-center justify-center gap-6 py-3 opacity-0 group-hover:opacity-100 z-20 transform translate-y-full group-hover:translate-y-0 transition-all duration-300">
      {% if card_product %}
        
        <button
          type="button"
          class="w-9 h-9 bg-white rounded-full flex items-center justify-center text-black transition-colors duration-400 hover:bg-[#71cd13]"
          aria-label="Quick view {{ card_title }}"
          data-quickview
          data-product-handle="{{ card_product.handle }}">
          {% render 'icon-eye' %}
        </button>

        <button
          type="button"
          class="w-9 h-9 bg-white rounded-full flex items-center justify-center text-black transition-colors duration-400 hover:bg-[#71cd13]"
          aria-label="Add {{ card_title }} to wishlist"
          data-wishlist
          data-product-handle="{{ card_product.handle }}">
          {% render 'icon-heart' %}
        </button>

        {% if quick_variant %}
          {% form 'product', card_product, id: product_form_id, class: 'product-card__form flex' %}
            <input type="hidden" name="id" value="{{ quick_variant.id }}">
            <button
              type="submit"
              name="add"
              class="w-9 h-9 bg-white rounded-full flex items-center justify-center text-black transition-colors duration-400 hover:bg-[#71cd13]"
              aria-label="Add {{ card_title }} to cart"
              data-quick-add
              data-variant-id="{{ quick_variant.id }}">
              {% render 'icon-cart' %}
            </button>
          {% endform %}
        {% endif %}

      {% endif %}
    </div>
  </div>

  <div class="product-btm p-5">
    <a href="{{ card_url }}" class="block">
      <h4 class="text-[14px] md:text-[13px] text-[#4A4A4A] group-hover:text-[#71cd13] transition-colors leading-tight">{{ card_title | upcase }}</h4>
    </a>
    <div class="mt-3 flex items-center gap-4">
      <span class="text-base font-semibold text-black">{{ card_price | money }}</span>
      {% if card_compare_at and card_compare_at > card_price %}
        <del class="text-gray-400 text-sm font-normal">{{ card_compare_at | money }}</del>
      {% endif %}
    </div>
  </div>
</div>